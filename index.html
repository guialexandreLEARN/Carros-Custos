<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carros e Custos</title>
</head>
<style>
    body {
        font-family: Arial, sans-serif;
        padding: 20px;
    }

    form {
        margin-bottom: 20px;
    }

    label {
        display: block;
        margin-bottom: 8px;
    }

    input {
        width: 100%;
        padding: 8px;
        margin-bottom: 10px;
        box-sizing: border-box;
    }

    button {
        padding: 10px 20px;
        background-color: #4CAF50;
        color: white;
        border: none;
        cursor: pointer;
    }

    button:hover {
        background-color: #45a049;
    }

    @media (min-width: 600px) {
        input {
            width: 50%;
        }
    }
</style>

<body>
    <h1>Gerenciar Carros e Custos</h1>

    <h2>Login</h2>
    <form id="loginForm">
        <label>Email: <input type="email" id="email" required></label><br>
        <label>Senha: <input type="password" id="password" required></label><br>
        <button type="submit">Entrar</button>
    </form>

    <!-- Botão de logout -->
    <button id="logoutButton" style="display: none;">Sair</button>

    <!-- Formulários para adicionar carro e custo -->
    <div id="forms" style="display: none;">
        <form id="carForm">
            <h3>Adicionar Carro</h3>
            <label>Ano de Fabricação: <input type="text" id="anoFab"></label><br>
            <label>Ano do Modelo: <input type="text" id="anoModelo"></label><br>
            <label>Cor: <input type="text" id="cor"></label><br>
            <label>Código FIPE: <input type="text" id="codigoFIPE"></label><br>
            <label>Litragem do Motor: <input type="text" id="litragemMotor"></label><br>
            <label>Marca: <input type="text" id="marca"></label><br>
            <label>Modelo: <input type="text" id="modelo"></label><br>
            <label>Placa Antiga: <input type="text" id="placaAntiga"></label><br>
            <label>Placa Mercosul: <input type="text" id="placaMercosul"></label><br>
            <label>RENAVAM (Chave Primária): <input type="text" id="renavam"></label><br>
            <label>Versão: <input type="text" id="versao"></label><br>
            <button type="submit">Adicionar Carro</button>
        </form>

        <form id="costForm">
            <h3>Adicionar Custo</h3>
            <label>Data: <input type="date" id="data"></label><br>
            <label>Descrição dos Custos: <input type="text" id="descricaoCustos"></label><br>
            <label>Método de Pagamento: <input type="text" id="metodoPagamento"></label><br>
            <label>RENAVAM (Relaciona com o carro): <input type="text" id="renavamCusto"></label><br>
            <label>Valor dos Custos: <input type="number" id="valorCustos"></label><br>
            <button type="submit">Adicionar Custo</button>
        </form>
    </div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js';
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/9.6.10/firebase-auth.js';
        import { getFirestore, collection, addDoc } from 'https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore.js';

        // Configuração Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyCWT72-XVlMkIBU64KhAbeZhaykRfln5As",
            authDomain: "vendascarro-estudo.firebaseapp.com",
            projectId: "vendascarro-estudo",
            storageBucket: "vendascarro-estudo.appspot.com",
            messagingSenderId: "1065254193744",
            appId: "1:1065254193744:web:0154a1cb974c9658c19f55",
            measurementId: "G-ME5MH151S1"
        };

        // Inicializar Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Função de login
        document.getElementById('loginForm').addEventListener('submit', function(event) {
            event.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            signInWithEmailAndPassword(auth, email, password)
                .then((userCredential) => {
                    alert('Login realizado com sucesso!');
                    document.getElementById('forms').style.display = 'block'; // Mostra os formulários após o login
                    document.getElementById('logoutButton').style.display = 'block'; // Mostra o botão de logout
                })
                .catch((error) => {
                    alert('Erro ao fazer login: ' + error.message);
                });
        });

        // Função de logout
        document.getElementById('logoutButton').addEventListener('click', function() {
            signOut(auth).then(() => {
                alert('Logout realizado com sucesso!');
                document.getElementById('forms').style.display = 'none'; // Esconde os formulários após o logout
                document.getElementById('logoutButton').style.display = 'none'; // Esconde o botão de sair
            }).catch((error) => {
                alert('Erro ao fazer logout: ' + error.message);
            });
        });

        // Verificação de autenticação
        onAuthStateChanged(auth, (user) => {
            if (user) {
                console.log('Usuário logado: ', user.email);
                document.getElementById('forms').style.display = 'block'; // Mostra os formulários se já estiver logado
                document.getElementById('logoutButton').style.display = 'block'; // Mostra o botão de logout se já estiver logado
            } else {
                console.log('Nenhum usuário logado');
            }
        });
    </script>
</body>
</html>
